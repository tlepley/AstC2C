##################################################################
#   <B>
#   \par  Description
#   Generation of builtin files
#   </B>
#
#   \par
#   This file is part of the AstC2C source-to-source compiler technology.
#   Redistribution of this file to outside parties is strictly prohibited
#   without the written consent of the module owner indicated below.\n
#
#   \par  Module owner:
#   Thierry Lepley, STMicroelectronics (thierry.lepley@st.com)
#
#   \par  STMicroelectronics Copyright (C) 2010
#
#   \par  Authors:
#   Thierry Lepley, STMicroelectronics (thierry.lepley@st.com)
#
##################################################################


all: external_builtin_types.h \
     kernel_builtins_runtime.hl \
     kernel_builtins_runtime.h kernel_builtins_runtime_clam.h



#-----------------------------
# Common CL types
#-----------------------------

external_builtin_types.h : src/external_builtin_types.h
	@cp $< .


#-----------------------------
# CL view of builtins
#-----------------------------

# Code parsed but not regenerated by the C2C
kernel_builtins_runtime.hl : src/kernel_builtins_runtime.hl
	@cpp -E -o $@ $<


#-----------------------------
# C implementation of builtins
#-----------------------------

# generic builtins implementation (for AstC2C)
kernel_builtins_runtime.h : src/kernel_builtins_runtime.h
	@cpp -E -o $@ $<

# CLAM specific (a part of builtins is provided by the CLAM runtime)
kernel_builtins_runtime_clam.h : src/kernel_builtins_runtime_clam.h
	@cpp -E -o $@ $<



#-----------------------------
# Cleaning rule
#-----------------------------

clean:
	@rm -f external_builtin_types.h \
	       kernel_builtins_runtime.hl \
	       kernel_builtins_runtime.h kernel_builtins_runtime_clam.h


#-----------------------------
# Dependencies
#-----------------------------

kernel_builtins_runtime.hl : src/kernel_runtime/external_builtin_types.hl src/kernel_runtime/async_copy.h src/kernel_runtime/work_item.hl src/kernel_runtime/synchro.hl

kernel_builtins_runtime.h : src/kernel_runtime/as_typen.h src/kernel_runtime/async_copy.h src/kernel_runtime/vloadstore.h src/kernel_runtime/synchro.h

kernel_builtins_runtime_clam.h : src/kernel_runtime/as_typen.h src/kernel_runtime/async_copy_clam.h src/kernel_runtime/vloadstore.h



